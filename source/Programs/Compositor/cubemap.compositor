// created by Andrey Vasiliev

//----------------------------------------------------------------------------------------------------------------------
// Abstract node to avoid copy & paste
//----------------------------------------------------------------------------------------------------------------------
abstract target CubeFace
{
    shadows off
    only_initial on

    pass clear {}
    pass render_scene
    {
        camera CubeCamera align_to_face
    }
}

abstract target CubeFaceSky
{
    shadows off
    only_initial on

    pass clear {}
    pass render_scene
    {
        last_render_queue 5 // render early sky only
        camera CubeCamera align_to_face
    }
}

//----------------------------------------------------------------------------------------------------------------------
// https://github.com/OGRECave/ogre/blob/6e1560ec9a920f72eb43182336926cdb7de596b4/Samples/Media/materials/scripts/Examples.compositor#L808
//----------------------------------------------------------------------------------------------------------------------
compositor CubeMap
{
    technique
    {
        texture cube 128 128 PF_R11G11B10_FLOAT cubic no_fsaa

        target cube 0 : CubeFace {}
        target cube 1 : CubeFace {}
        target cube 2 : CubeFace {}
        target cube 3 : CubeFace {}
        target cube 4 : CubeFace {}
        target cube 5 : CubeFace {}
    }
}

compositor CubeMapSky
{
    technique
    {
        texture cube 128 128 PF_R11G11B10_FLOAT cubic no_fsaa

        target cube 0 : CubeFaceSky {}
        target cube 1 : CubeFaceSky {}
        target cube 2 : CubeFaceSky {}
        target cube 3 : CubeFaceSky {}
        target cube 4 : CubeFaceSky {}
        target cube 5 : CubeFaceSky {}
    }
}
